<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coil Resistance & Inductance Calculator</title>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="stylesheet" href="style.css">
    <style>
        /* 테마 변경 시 MathJax 폰트 색상이 바뀌도록 추가 */
        .mjx-chtml {
            color: var(--text-primary);
        }
    </style>
</head>
<body>

    <header class="header">
        <div class="header-content">
            <h1 class="page-title">Coil Calculator</h1>
            <button class="theme-toggle" id="theme-toggle-btn" aria-label="Toggle theme">
                </button>
        </div>
    </header>

    <main class="container">
        <section class="hero animate-in">
            <h1>Coil Resistance & Inductance Calculator</h1>
            <p>표피 효과와 근접 효과를 고려하여 나선형 및 헬리컬 코일의 AC 저항과 자체 인덕턴스를 계산하는 고급 도구입니다.</p>
        </section>

        <div class="grid grid-2">
            <div class="card animate-in" id="input-card">
                <h2 class="card-title">
                    <span class="card-icon">⚙️</span>
                    Input Parameters
                </h2>
                <div class="core-image">
                    <img src="https://emlizard.github.io/main-page/images/diagram_acr2.png" alt="Coil Diagram">
                </div>

                <div class="parameter-grid">
                    <div class="input-group">
                        <label for="f" class="input-label">Frequency <span class="input-unit">(MHz)</span></label>
                        <input id="f" type="number" value="1" step="any" class="input-field">
                    </div>
                    <div class="input-group">
                        <label for="s" class="input-label">Conductivity <span class="input-unit">(×10⁷ S/m)</span></label>
                        <input id="s" type="number" value="5.8" step="any" class="input-field">
                    </div>
                </div>

                <div class="dimension-grid">
                    <div class="input-group">
                        <label for="r0" class="input-label">Wire Radius <span class="input-unit">(mm)</span></label>
                        <input id="r0" type="number" value="0.5" step="any" class="input-field">
                    </div>
                    <div class="input-group">
                        <label for="N" class="input-label">Turns <span class="input-unit">(N)</span></label>
                        <input id="N" type="number" value="6" step="1" class="input-field">
                    </div>
                    <div class="input-group">
                        <label for="OD" class="input-label">Outer Diameter <span class="input-unit">(mm)</span></label>
                        <input id="OD" type="number" value="200" step="any" class="input-field">
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label">Coil Shape</label>
                    <div class="radio-group">
                        <label><input type="radio" name="coilShape" value="spiral" checked> Spiral</label>
                        <label><input type="radio" name="coilShape" value="helical"> Helical</label>
                    </div>
                </div>

                <div class="input-group">
                    <label class="input-label">Pitch Type</label>
                    <div class="radio-group">
                        <label><input type="radio" name="pitchType" value="identical" checked onchange="togglePitch()"> Identical</label>
                        <label><input type="radio" name="pitchType" value="unequal" onchange="togglePitch()"> Unequal</label>
                    </div>
                </div>

                <div id="identicalPitchInput" class="input-group">
                    <label for="p0" class="input-label">Pitch <span class="input-unit">(mm)</span></label>
                    <input id="p0" type="number" value="1.2" step="any" class="input-field">
                </div>
                <div id="unequalPitchInput" class="input-group" style="display:none;">
                    <label for="pList" class="input-label">Pitches pᵢ <span class="input-unit">(mm, comma-separated)</span></label>
                    <textarea id="pList" class="input-field">1,1,1,1,1</textarea>
                </div>

                <button class="btn btn-full" onclick="calculate()">
                    ⚡ Calculate
                </button>
            </div>

            <div class="card animate-in" id="output-card">
                <h2 class="card-title">
                    <span class="card-icon">📊</span>
                    Calculation Results
                </h2>
                <div class="result-display" id="result-container">
                    <div class="placeholder-state">
                        <p>결과는 계산 버튼을 누르면 여기에 표시됩니다.</p>
                    </div>
                    </div>
            </div>
        </div>

        <section class="formula-section card animate-in">
            <h3 class="card-title">Formulas Used</h3>
            <div class="formula-content">
                <p><strong>DC Resistance ($R_{DC}$)</strong></p>
                $$R_{DC} = \frac{\ell_{\text{total}}}{\sigma \pi r_{0}^{2}}$$
                <p><strong>AC Resistance ($R_{AC}$), including Skin & Proximity Effects</strong></p>
                $$R_{AC} = R_{\text{skin}} (1 + G_p)$$
                Where $\delta = (\pi f \mu_0 \sigma)^{-1/2}$ is the skin depth and $G_p$ is the proximity factor derived from magnetic field components.
                <p><strong>Self-Inductance (L)</strong></p>
                The inductance is calculated by summing the self-inductance of each turn ($M_{ii}$) and the mutual inductance between all pairs of turns ($M_{ij}$), using complete elliptic integrals $K(m)$ and $E(m)$.
                $$ L = \sum_{i=1}^{N}\sum_{j=1}^{N} M_{ij} $$
                $$ M_{ii} = \mu_{0}r_{i}\left(\ln\frac{8r_{i}}{r_{0}} - 1.75\right) $$
                $$ M_{ij} = \mu_{0}\sqrt{\frac{r_{i}r_{j}}{m}}\left((2-m)K(m) - 2E(m)\right) $$
            </div>
        </section>
    </main>

    <script src="script.js"></script>
</body>
</html>
